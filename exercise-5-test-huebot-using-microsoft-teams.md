# Exercise 5: Test HueBot Using Microsoft Teams

### Get your Office 365 Tenant ID

Logon to Azure portal and click on Azure Active Directory from the left menu. Now click on properties from the blade menu and copy your Directory ID. We will use it later in this Exercise

![](.gitbook/assets/image%20%2856%29.png)

### Schedule a Teams Meeting for testing

Now that you have successfully published your Bot application to the Azure cloud services it time to test your work. Logon to Microsoft Teams [https://teams.microsoft.com](https://teams.microsoft.com) with your Office 365 Developer subscription as administrator. Its easier to use the browser based client but you must use either Edge or Chrome browser to support audio and video.

Once you are logged in to Teams create a new meeting.

![](.gitbook/assets/image%20%284%29.png)

Enter a meeting title and invite at least one additional user to the meeting.

![](.gitbook/assets/image%20%2859%29.png)

Now copy the meeting URL from the newly created meeting we are going to use it later in this exercise.

![](.gitbook/assets/image%20%2868%29.png)

### Install Postman

We will use postman to submit an HTTP POST command to the Bot. Download and install postman from here: [https://app.getpostman.com/app/download/win64](https://app.getpostman.com/app/download/win64)

![](.gitbook/assets/image%20%2890%29.png)

Once postman is installed you will need to create an account if you already have one just sign in.

![](.gitbook/assets/image%20%2869%29.png)

There will be a default request when the application starts. Change this request from a GET to a POST

![](.gitbook/assets/image%20%2857%29.png)

Enter the following URL in the request URL text box: [https://huebotlab999.teamsbots.com/joinCall ](https://huebotlab999.teamsbots.com/joinCall%20)

![](.gitbook/assets/image%20%2830%29.png)

Click on the Headers tab and enter new header for **Content-Type** with the value as **application/json**

![](.gitbook/assets/image%20%2835%29.png)

Now click on the Body tab, select RAW and paste the following JSON syntax into postman.

```text
{
        "TenantId": "YOUR TENANT ID",
        "JoinURL": "YOUR MEETING ID"
}
```

![](.gitbook/assets/image%20%2812%29.png)

### Join Teams Meeting

Now return to Teams and join the meeting you created in the previous step. Once you are joined start your audio and video. You will need to join the meeting using a client that has access to audio and video. 

{% hint style="info" %}
The lab virtual server will not have audio or video.
{% endhint %}

![](.gitbook/assets/image%20%2816%29.png)

Now return to postman and submit the HTTP POST command. You will see huebot join your meeting and it should begin to stream back your video.

![](.gitbook/assets/image%20%2842%29.png)

You should get a response with a GUID. This is the new callID generated by Teams. Return to your Teams meeting and you should see HueBot appear in the roster.

![](.gitbook/assets/image%20%2848%29.png)

![](.gitbook/assets/image.png)

